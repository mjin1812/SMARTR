<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SMARTR">
<title>4. Example analysis notebook • SMARTR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4. Example analysis notebook">
<meta property="og:description" content="SMARTR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SMARTR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/SMARTR.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/1.Segmentation.html">1. Imaging, segmentation, and preprocessing</a>
    <a class="dropdown-item" href="../articles/2.Tutorial.html">2. Mapping Tutorial</a>
    <a class="dropdown-item" href="../articles/3.Scripting.html">3. Scripting &amp; notebooks</a>
    <a class="dropdown-item" href="../articles/4.Example%20Analysis%20Notebook.html">4. Example analysis notebook</a>
    <a class="dropdown-item" href="../articles/5.FAQ.html">5. FAQ</a>
    <a class="dropdown-item" href="../articles/6.Development.html">6. Development environment</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>4. Example analysis notebook</h1>
            
      
      
      <div class="d-none name"><code>4.Example Analysis Notebook.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="analysis-setup">1 Analysis Setup<a class="anchor" aria-label="anchor" href="#analysis-setup"></a>
</h2>
<p>In this analysis tutorial we will load the learned helplessness
dataset as an experiment object and walk through the analysis and
visualization functions in SMARTR with it. You can download the learned
helplessness dataset <a href="https://osf.io/fhrxj" class="external-link">here</a>! Please see
the accompanying paper for an in-depth explanation of the behavioral
groups used in this experiment.</p>
<div class="section level3">
<h3 id="load-the-libraries-and-data-needed">1.1 Load the libraries and data needed<a class="anchor" aria-label="anchor" href="#load-the-libraries-and-data-needed"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SMARTR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install rstatix if it is not installed already</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/" class="external-link">rstatix</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Re-routing the quartz function call for Macs to the X11 graphics call for windows/linux setups</span></span>
<span><span class="va">quartz</span> <span class="op">&lt;-</span> <span class="va">x11</span></span></code></pre></div>
<p>Load the experiment object</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the experiment data </span></span>
<span><span class="co"># Change to point to the experiment object downloaded</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"V:\\Michelle_Jin\\Wholebrain pipeline\\LH_analysis\\learned_helplessness_experiment.RDATA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change where the analysis folder is stored in the experiment object</span></span>
<span><span class="co"># Edit the path below to point your own folder location</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">lh</span>, <span class="st">"info"</span><span class="op">)</span><span class="op">$</span><span class="va">output_path</span> <span class="op">&lt;-</span> <span class="st">"V:\\Michelle_Jin\\Wholebrain pipeline\\LH_analysis"</span> </span>
<span></span>
<span><span class="co"># print the experiment object to see what attributes are available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lh</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $experiment_name</span></span>
<span><span class="co">## [1] "learned_helplessness"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $experimenters</span></span>
<span><span class="co">## [1] "MJ" "SO"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $channels</span></span>
<span><span class="co">## [1] "cfos"    "eyfp"    "colabel"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $experiment_groups</span></span>
<span><span class="co">## [1] "Shock"   "Context"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $drug_groups</span></span>
<span><span class="co">## [1] "MJ" NA  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sex_groups</span></span>
<span><span class="co">## [1] "male"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $cohorts</span></span>
<span><span class="co">## [1] NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $strains</span></span>
<span><span class="co">## [1] "129S" "129" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $genotypes</span></span>
<span><span class="co">## [1] "pos"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $reporters</span></span>
<span><span class="co">## [1] "eyfp"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ages</span></span>
<span><span class="co">## [1] 6.39 7.18 6.52 6.33 7.11 5.41</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $output_path</span></span>
<span><span class="co">## [1] "V:\\Michelle_Jin\\Wholebrain pipeline\\LH_analysis"</span></span></code></pre>
<p>Print the names of the current data stored within the experiment
object</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "mice"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="combine-the-processed-cell-counts-across-all-the-mice-">1.2 Combine the processed cell counts across all the mice.<a class="anchor" aria-label="anchor" href="#combine-the-processed-cell-counts-across-all-the-mice-"></a>
</h3>
<p>This concatenates the normalized regional cell count table from each
mouse into one long dataframe. The <code>by</code> parameter is a list
of the mouse attributes types you want to use to make analysis
subgroups. For example, you would include
<code>by = c('sex','age')</code> if you wanted to perform an analysis
where the data is grouped by both males and females and age of the
subjects.</p>
<p>In our dataset <code>Shock</code> and <code>Context</code> are stored
in the flexible generic attribute <code>group</code>, so we use that for
the <code>by</code> variable.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_cell_counts.html">combine_cell_counts</a></span><span class="op">(</span><span class="va">lh</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'group'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print the name of stored data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "mice"                           "combined_normalized_counts"    </span></span>
<span><span class="co">## [3] "combined_counts_per_slice_list"</span></span></code></pre>
<p>There should now be a new list called
<code>combined_normalized_counts</code>, where each element is a
combined normalized cell count table per channel.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the names of each channel cell count table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "cfos"    "eyfp"    "colabel"</span></span></code></pre>
<p>If there are specific regions you would like to exclude from your
analysis, you can do so using the code below by entering region acronyms
into the <code>toremove</code> vector. Here, we demonstrate removing the
CA2 region.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toremove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CA2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">channels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">)</span></span>
<span><span class="va">toremove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">toremove</span>, <span class="fu">SMARTR</span><span class="fu">::</span><span class="fu"><a href="../reference/get.sub.structure.html">get.sub.structure</a></span><span class="op">(</span><span class="va">toremove</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">channel</span> <span class="kw">in</span> <span class="va">channels</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">[[</span><span class="va">channel</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">[[</span><span class="va">channel</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">acronym</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">toremove</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="normalize-colabelled-counts-by-a-particular-channel-">1.3 Normalize colabelled counts by a particular channel.<a class="anchor" aria-label="anchor" href="#normalize-colabelled-counts-by-a-particular-channel-"></a>
</h3>
<p>This is an optional step, but is particularly pertinent to those
doing engram research. Sometimes we want to normalize the number of
colabelled cells per region over the number of eYFP cells or c-Fos
cells.</p>
<p>This allows users to gauge the fraction of cells “reactivated” from
an original ensemble population (colabel+/eYFP+) or the number of
reactivated cells as a proportion of the ensembles active during memory
expression (colabel+/c-Fos+). We leave the choice to use either/both of
these denominators to further analyze the data up to users.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Normalize the colabelled counts by a particular channel</span></span>
<span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_colabel_counts.html">normalize_colabel_counts</a></span><span class="op">(</span><span class="va">lh</span>, denominator_channel <span class="op">=</span> <span class="st">"eyfp"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Uncomment the following line if you would like to also analyze colabelled cells normalized by c-Fos</span></span>
<span><span class="co"># lh &lt;- normalize_colabel_counts(lh, denominator_channel = "cfos")</span></span>
<span></span>
<span><span class="co"># Print the names of each channel cell count table. New channels, where colabelled counts are normalized by </span></span>
<span><span class="co"># eyfp and/or cfos should be present.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "cfos"              "eyfp"              "colabel"          </span></span>
<span><span class="co">## [4] "colabel_over_eyfp"</span></span></code></pre>
<p>The normalized colabelled counts can now be treated as an independent
channel to analyze.</p>
</div>
<div class="section level3">
<h3 id="quality-checking-all-region-outlier-counts-across-all-channels-">1.4 Quality checking all region outlier counts across all
channels.<a class="anchor" aria-label="anchor" href="#quality-checking-all-region-outlier-counts-across-all-channels-"></a>
</h3>
<p>Details of these functions are covered in the mapping tutorial page.
Removing all region outliers where counts above or below 2 standard
deviations of the group mean are removed. This is evaluated in
independently per channel.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_outlier_counts.html">find_outlier_counts</a></span><span class="op">(</span><span class="va">lh</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>, n_sd <span class="op">=</span> <span class="fl">2</span>, remove <span class="op">=</span> <span class="cn">TRUE</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## There were 1 outliers found. Outliers were based on within group mean and standard deviation.</span></span></code></pre>
<pre><code><span><span class="co">## Saved regions outliers dataframe at:</span></span>
<span><span class="co">## V:\Michelle_Jin\Wholebrain pipeline\LH_analysis/region_count_outliers_cfos.csv</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 x 10</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   acronym [1]</span></span></span>
<span><span class="co">##   mouse_ID group acronym name   count area.mm2 volume.mm3 normalized.count.by.~1</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>      </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>                  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>      732 Shock RE      Nucle~   108   0.066</span><span style="text-decoration: underline;">6</span><span>   0.000</span><span style="text-decoration: underline;">600</span><span>                  </span><span style="text-decoration: underline;">1</span><span>621.</span></span></span>
<span><span class="co">## <span style="color: #949494;"># i abbreviated name: 1: normalized.count.by.area</span></span></span>
<span><span class="co">## <span style="color: #949494;"># i 2 more variables: normalized.count.by.volume &lt;dbl&gt;, outlier &lt;lgl&gt;</span></span></span></code></pre>
<pre><code><span><span class="co">## There were 3 outliers found. Outliers were based on within group mean and standard deviation.</span></span></code></pre>
<pre><code><span><span class="co">## Saved regions outliers dataframe at:</span></span>
<span><span class="co">## V:\Michelle_Jin\Wholebrain pipeline\LH_analysis/region_count_outliers_eyfp.csv</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 x 10</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   acronym [3]</span></span></span>
<span><span class="co">##   mouse_ID group acronym name   count area.mm2 volume.mm3 normalized.count.by.~1</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>      </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>                  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>     </span><span style="text-decoration: underline;">9</span><span>755 Shock FC      Fasci~    24    0.114    0.001</span><span style="text-decoration: underline;">03</span><span>                  210. </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span><span>      669 Shock OT      Olfac~   309    2.14     0.019</span><span style="text-decoration: underline;">3</span><span>                   144. </span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span><span>      669 Shock SI      Subst~   129    2.51     0.022</span><span style="text-decoration: underline;">6</span><span>                    51.5</span></span></span>
<span><span class="co">## <span style="color: #949494;"># i abbreviated name: 1: normalized.count.by.area</span></span></span>
<span><span class="co">## <span style="color: #949494;"># i 2 more variables: normalized.count.by.volume &lt;dbl&gt;, outlier &lt;lgl&gt;</span></span></span></code></pre>
<pre><code><span><span class="co">## There were 1 outliers found. Outliers were based on within group mean and standard deviation.</span></span></code></pre>
<pre><code><span><span class="co">## Saved regions outliers dataframe at:</span></span>
<span><span class="co">## V:\Michelle_Jin\Wholebrain pipeline\LH_analysis/region_count_outliers_colabel.csv</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 x 10</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   acronym [1]</span></span></span>
<span><span class="co">##   mouse_ID group acronym name   count area.mm2 volume.mm3 normalized.count.by.~1</span></span>
<span><span class="co">##      <span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span> </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;int&gt;</span><span>    </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>      </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span><span>                  </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span><span>      669 Shock LA      Later~     3    0.151    0.001</span><span style="text-decoration: underline;">36</span><span>                   19.8</span></span></span>
<span><span class="co">## <span style="color: #949494;"># i abbreviated name: 1: normalized.count.by.area</span></span></span>
<span><span class="co">## <span style="color: #949494;"># i 2 more variables: normalized.count.by.volume &lt;dbl&gt;, outlier &lt;lgl&gt;</span></span></span></code></pre>
<pre><code><span><span class="co">## No regions outliers were found within each group for channel colabel_over_eyfp</span></span></code></pre>
<p>Making sure a minimum of mice per group are represented in each
region count.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/enough_mice_per_group.html">enough_mice_per_group</a></span><span class="op">(</span><span class="va">lh</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>, min_n <span class="op">=</span> <span class="fl">4</span>, remove <span class="op">=</span> <span class="cn">TRUE</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Removed regions for cfos channel.</span></span></code></pre>
<pre><code><span><span class="co">## Removed regions for eyfp channel.</span></span></code></pre>
<pre><code><span><span class="co">## Removed regions for colabel channel.</span></span></code></pre>
<pre><code><span><span class="co">## Removed regions for colabel_over_eyfp channel.</span></span></code></pre>
<pre><code><span><span class="co">## There were regions below the minimum n:</span></span></code></pre>
<pre><code><span><span class="co">## Saved regions below the threshold at location: V:\Michelle_Jin\Wholebrain pipeline\LH_analysis/regions_below_N_thresh.csv</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="analysis-statistical-comparisons-and-visualization-functions">2 Analysis, statistical comparisons and visualization functions<a class="anchor" aria-label="anchor" href="#analysis-statistical-comparisons-and-visualization-functions"></a>
</h2>
<p>It is helpful to now conceptualize analysis as composed of two parts:
1) One function performs data wrangling or analysis behind the scenes.
2) The second function is responsible for visualization, with built-in
auto-export of figures.</p>
<p>This section will cover the analysis and transformation of data
stored in the experiment object. Visualization/plotting, and export of
the figures from these functions will be covered in section 3. The data
output from these analyses will typically be stored in the experiment
object if it is a <code>SMARTR</code> package function. Depending on the
function, data can be auto-exported as a .csv file to the experiment
output folder.</p>
<div class="section level3">
<h3 id="exporting-formatted-regional-counts-list-with-multiple-comparisons-correction">2.1 Exporting formatted regional counts list with multiple
comparisons correction<a class="anchor" aria-label="anchor" href="#exporting-formatted-regional-counts-list-with-multiple-comparisons-correction"></a>
</h3>
<p>Generating an a formatted regional counts list with an false
discovery rate correction (FDR) can be performed with the
<code>dplyr</code> and <code>rstatix</code> package functions. A
user-friendly function to perform this flexibly with multiple groupings
is planned to be incorporated later into the <code>SMARTR</code>
package.</p>
<div class="section level4">
<h4 id="perform-pairwise-group-comparisons-in-region-counts-and-correct-for-multiple-comparisons">Perform pairwise group comparisons in region counts and correct for
multiple comparisons<a class="anchor" aria-label="anchor" href="#perform-pairwise-group-comparisons-in-region-counts-and-correct-for-multiple-comparisons"></a>
</h4>
<p>The code below uses the FDR (Benjamini-Hochberg) method for adjusting
the p-values for multiple comparisons. It is done separately for the
eYFP, c-Fos, and colabel/eYFP channels.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats.eyfp</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">$</span><span class="va">eyfp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">acronym</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html" class="external-link">t_test</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">~</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/adjust_pvalue.html" class="external-link">adjust_pvalue</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/add_significance.html" class="external-link">add_significance</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stats.cfos</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">$</span><span class="va">cfos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">acronym</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html" class="external-link">t_test</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">~</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/adjust_pvalue.html" class="external-link">adjust_pvalue</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/add_significance.html" class="external-link">add_significance</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stats.colabel_over_eyfp</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">$</span><span class="va">colabel_over_eyfp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">acronym</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html" class="external-link">t_test</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">~</span><span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/adjust_pvalue.html" class="external-link">adjust_pvalue</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/add_significance.html" class="external-link">add_significance</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-summary-table-for-eyfp">Create summary table for eYFP<a class="anchor" aria-label="anchor" href="#create-summary-table-for-eyfp"></a>
</h4>
<p>The following code pivots the stats table to long form to concatenate
with the raw normalized counts</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wide_eyfp_norm_counts</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">$</span><span class="va">eyfp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">acronym</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean.normalized.count.by.volume <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">)</span>,</span>
<span>      sem.normalized.count.by.volume <span class="op">=</span> <span class="fu">SMARTR</span><span class="fu">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wide_eyfp_norm_counts</span> <span class="op">&lt;-</span>  <span class="va">wide_eyfp_norm_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span>  <span class="va">group</span>, names_sep <span class="op">=</span> <span class="st">"."</span>, values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">acronym</span>, <span class="va">name</span>, <span class="va">mean.normalized.count.by.volume</span>, <span class="va">sem.normalized.count.by.volume</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>acronym <span class="op">=</span> <span class="va">acronym.Context</span>,</span>
<span>                          name <span class="op">=</span> <span class="va">name.Context</span><span class="op">)</span></span>
<span></span>
<span><span class="va">joined_eyfp_stats</span> <span class="op">&lt;-</span> <span class="va">wide_eyfp_norm_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">acronym</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sem"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">stats.eyfp</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"acronym"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">.y.</span>, <span class="op">-</span><span class="va">group1</span>, <span class="op">-</span><span class="va">group2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>n.Context <span class="op">=</span> <span class="va">n1</span>, n.Shock <span class="op">=</span> <span class="va">n2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">lh</span>, <span class="st">"info"</span><span class="op">)</span><span class="op">$</span><span class="va">output_path</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"eyfp_regions_stats_table.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">joined_eyfp_stats</span>, <span class="va">file_name</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-summary-table-for-c-fos">Create summary table for c-Fos<a class="anchor" aria-label="anchor" href="#create-summary-table-for-c-fos"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wide_cfos_norm_counts</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">$</span><span class="va">cfos</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">acronym</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean.normalized.count.by.volume <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">)</span>,</span>
<span>      sem.normalized.count.by.volume <span class="op">=</span> <span class="fu">SMARTR</span><span class="fu">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wide_cfos_norm_counts</span> <span class="op">&lt;-</span>  <span class="va">wide_cfos_norm_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span>  <span class="va">group</span>, names_sep <span class="op">=</span> <span class="st">"."</span>, values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">acronym</span>, <span class="va">name</span>, <span class="va">mean.normalized.count.by.volume</span>, <span class="va">sem.normalized.count.by.volume</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>acronym <span class="op">=</span> <span class="va">acronym.Context</span>,</span>
<span>                          name <span class="op">=</span> <span class="va">name.Context</span><span class="op">)</span></span>
<span></span>
<span><span class="va">joined_cfos_stats</span> <span class="op">&lt;-</span> <span class="va">wide_cfos_norm_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">acronym</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sem"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">stats.cfos</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"acronym"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">.y.</span>, <span class="op">-</span><span class="va">group1</span>, <span class="op">-</span><span class="va">group2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>n.Context <span class="op">=</span> <span class="va">n1</span>,</span>
<span>                                             n.Shock <span class="op">=</span> <span class="va">n2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">lh</span>, <span class="st">"info"</span><span class="op">)</span><span class="op">$</span><span class="va">output_path</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"cfos_regions_stats_table.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">joined_cfos_stats</span>, <span class="va">file_name</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="create-summary-table-for-colabeleyfp-channels">Create summary table for colabel/eYFP channels<a class="anchor" aria-label="anchor" href="#create-summary-table-for-colabeleyfp-channels"></a>
</h4>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wide_colabel_over_eyfp_norm_counts</span> <span class="op">&lt;-</span> <span class="va">lh</span><span class="op">$</span><span class="va">combined_normalized_counts</span><span class="op">$</span><span class="va">colabel_over_eyfp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">acronym</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean.normalized.count.by.volume <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">)</span>,</span>
<span>      sem.normalized.count.by.volume <span class="op">=</span> <span class="fu">SMARTR</span><span class="fu">::</span><span class="fu"><a href="../reference/sem.html">sem</a></span><span class="op">(</span><span class="va">normalized.count.by.volume</span><span class="op">)</span>,</span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wide_colabel_over_eyfp_norm_counts</span> <span class="op">&lt;-</span>  <span class="va">wide_colabel_over_eyfp_norm_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span>  <span class="va">group</span>, names_sep <span class="op">=</span> <span class="st">"."</span>, values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">acronym</span>, <span class="va">name</span>, <span class="va">mean.normalized.count.by.volume</span>, <span class="va">sem.normalized.count.by.volume</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>acronym <span class="op">=</span> <span class="va">acronym.Context</span>,</span>
<span>                          name <span class="op">=</span> <span class="va">name.Context</span><span class="op">)</span></span>
<span></span>
<span><span class="va">joined_colabel_over_eyfp_stats</span> <span class="op">&lt;-</span> <span class="va">wide_colabel_over_eyfp_norm_counts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">acronym</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sem"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">stats.colabel_over_eyfp</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"acronym"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">.y.</span>, <span class="op">-</span><span class="va">group1</span>, <span class="op">-</span><span class="va">group2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>n.Context <span class="op">=</span> <span class="va">n1</span>,</span>
<span>                                             n.Shock <span class="op">=</span> <span class="va">n2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">lh</span>, <span class="st">"info"</span><span class="op">)</span><span class="op">$</span><span class="va">output_path</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"colabel_over_eyfp_regions_stats_table.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">joined_colabel_over_eyfp_stats</span>, <span class="va">file_name</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="get-pairwise-region-correlations">2.2 Get pairwise region correlations<a class="anchor" aria-label="anchor" href="#get-pairwise-region-correlations"></a>
</h3>
<p>The <code><a href="../reference/get_correlations.html">get_correlations()</a></code> function is used to calculate
pairwise Pearson correlations across all regions within an analysis
group. This can be done for each channel. Later we can use this to
generate a correlation heatmap. There is also an option to adjust for
p-values using different multiple comparisons methods using the and a
user-specified alpha value can also be applied to threshold
significance. Check the function’s help page for more details.</p>
<p>Like previous functions, there is a <code>by</code> parameter so the
analysis is focused on the correct grouping variables and values to
stratify your data into groups. Because each heat map is calculated for
one set of grouping variable values, these need to be specified with the
<code>values</code> parameter. The following example will generated a
correlation matrix for the eyfp channel independently for the Context
and Shock groups. For this channel we have decided to use an alpha
threshold of 0.005 for indicating significantly correlated regions. You
can add additional channels to process, if you would like to use the
same alpha across all channels.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get correlations for the eyfp </span></span>
<span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_correlations.html">get_correlations</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                       by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Context"</span><span class="op">)</span>,</span>
<span>                       channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                       p_adjust_method <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                       alpha <span class="op">=</span>  <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_correlations.html">get_correlations</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                       by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Shock"</span><span class="op">)</span>,</span>
<span>                       channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                       p_adjust_method <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                       alpha <span class="op">=</span>  <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p>Because the values of the grouping variables identify a unique
analysis group, they are used to name the stored results in the
experiment separated, with values separated by an “_“. For example, in
the analysis above, the results are stored as <code>Context</code> and
<code>Shock</code>. If the analysis instead used the parameters
<code>by = c("sex", "group"), values = c("female", "AD")</code>, the
results would be stored as a list under the name <code>female_AD</code>.
We will refer to this as the <code>correlation_list_name</code>.</p>
<p>You can check all the <code>correlation_list_name</code> values you
have by printing them:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">$</span><span class="va">correlation_list</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Context" "Shock"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="permute-pairwise-region-correlation-differences-between-groups">2.3 Permute pairwise region correlation differences between
groups<a class="anchor" aria-label="anchor" href="#permute-pairwise-region-correlation-differences-between-groups"></a>
</h3>
<p>We can compare the difference between pairwise region correlations
between two different analysis groups using a permutation analysis. For
this we’ll use the function <code><a href="../reference/correlation_diff_permutation.html">correlation_diff_permutation()</a></code>.
This function requires you to have run <code><a href="../reference/get_correlations.html">get_correlations()</a></code>
for each analysis group and channel that you want to compare prior to
using it.</p>
<p>It also allows you to specify the number of shuffles and the random
seed number (for figure replication). Additionally, there is an option
for multiple comparison’s adjustment; if applied, the previous
adjustment from <code><a href="../reference/get_correlations.html">get_correlations()</a></code> is not redundantly
applied. Multiple comparisons adjustment will change the p-value that is
later plotted in a volcano plot.</p>
<p>In the example below, we will compare the <code>Context</code>
analysis group with the <code>Shock</code> group.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correlation_diff_permutation.html">correlation_diff_permutation</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                                   correlation_list_name_1 <span class="op">=</span> <span class="st">"Context"</span>,</span>
<span>                                   correlation_list_name_2 <span class="op">=</span> <span class="st">"Shock"</span>,</span>
<span>                                   channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                                   p_adjust_method <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                                   alpha <span class="op">=</span> <span class="fl">0.01</span></span>
<span>                                   <span class="op">)</span></span></code></pre></div>
<p>The results of the analysis are stored within the experiment object
in list called permutation_p_matrix</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lh</span><span class="op">$</span><span class="va">permutation_p_matrix</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Context_vs_Shock"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="create-region-networks-with-summary-stats">2.4 Create region networks with summary stats<a class="anchor" aria-label="anchor" href="#create-region-networks-with-summary-stats"></a>
</h3>
<p>Now we can move on to the process of automatically creating networks
in R using the <code><a href="../reference/create_networks.html">create_networks()</a></code> function. This function is
also contingent on running <code><a href="../reference/get_correlations.html">get_correlations()</a></code> first because
these networks are constructed on the correlation coefficents.</p>
<p>The <code>alpha</code> parameters specifies at which threshold a node
is included in the networks based on p-values of pairwise-region
correlation coefficients. To keep the edges include in the network the
same as those indicated as significant in correlation heatmaps, set the
<code>alpha</code> parameter to be the same.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_networks.html">create_networks</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                      correlation_list_name <span class="op">=</span> <span class="st">"Context"</span>,</span>
<span>                      channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                      pearson_thresh <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span>
<span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_networks.html">create_networks</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                      correlation_list_name <span class="op">=</span> <span class="st">"Shock"</span>,</span>
<span>                      channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                      pearson_thresh <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span></code></pre></div>
<p>After running this function,a network object for each channel per
analysis group was created using tidygraph and they have been stored in
our experiment object. We can access the data with
<code>lh$networks$&lt;network_name&gt;</code> where network_name is
identical to the <code>correlation_list_name</code> used to generate the
network.</p>
<p>Now there are some network summary statistics that we can calculate
using our network object. We will calculate them using the function
<code><a href="../reference/summarise_networks.html">summarise_networks()</a></code>. This function is designed to
summarize the stats of multiple networks at once if they are supplied to
the parameter network_names.</p>
<p>The additional parameters <code>save_stats</code>,
<code>save_degree_distribution</code>,
<code>save_betweenness_distribution</code>, and
<code>save_efficiency_distribution</code> are used to save the indicated
network summary statistics as csv files in the experiment object folder.
This is handy if you would prefer to graph these values externally in
another software, such as Graphpad Prism instead of R.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarise_networks.html">summarise_networks</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                         channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                         network_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Context"</span>, <span class="st">"Shock"</span><span class="op">)</span>,</span>
<span>                         save_stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         save_degree_distribution <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         save_betweenness_distribution <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         save_efficiency_distribution <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(group)`Joining with `by = join_by(group)`</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="plotting-visualization-functions">3 Plotting &amp; Visualization functions<a class="anchor" aria-label="anchor" href="#plotting-visualization-functions"></a>
</h2>
<p>All of this hard work will allow us to generate some beautiful plots.
First there are some conventions to note for plotting functions. Unlike
all the other package functions presented here, we will not be assigning
the output of a plotting function to our experiment object. There is no
return value for plotting functions. This is because no analysis is
being done and the primary output that we want is either a graphics
window, or an image saved to our output folder.</p>
<p>Almost all the functions will have parameters allowing you to specify
the height and width in inches, the image extension (e.g. “.png”,
“.jpg”), as well as colors (or color palettes) to save your plot as.
Some of the functions will allow you to adjust the xlim and the ylim of
your axes in order to fit the data or change the plot aesthestics by
adding on your own ggplot() theme. Pull up the help pages to see what
plot characteristics are customizable for each function!</p>
<div class="section level3">
<h3 id="bar-plot-across-all-regions">3.1 Bar plot across all regions<a class="anchor" aria-label="anchor" href="#bar-plot-across-all-regions"></a>
</h3>
<p>To plot a broad overview of the counts per group across all mapped
regions for each channel, we can use the
<code>plot_normalized_counts</code> function. There are a variety of
visualization parameters that are user-modifiable, including the bar
colors per group. Note that currently, this function is only equipped to
plot based on the generic <code>group</code> attribute rather than other
attributes such as <code>age</code> or <code>sex</code>.</p>
<div class="section level4">
<h4 id="plotting-all-regions-with-mapped-eyfp-counts">Plotting all regions with mapped eYFP counts<a class="anchor" aria-label="anchor" href="#plotting-all-regions-with-mapped-eyfp-counts"></a>
</h4>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chose the group colors for the eyfp channel to plot as a hexadecimal color code</span></span>
<span><span class="va">eyfp.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Context <span class="op">=</span> <span class="st">"#FFFFFF"</span>, Shock <span class="op">=</span> <span class="st">"#028A0F"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot a long region bar plot</span></span>
<span><span class="fu"><a href="../reference/plot_normalized_counts.html">plot_normalized_counts</a></span><span class="op">(</span>e <span class="op">=</span> <span class="va">lh</span>,</span>
<span>                       channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Context"</span>, <span class="st">"Shock"</span><span class="op">)</span>,</span>
<span>                       colors <span class="op">=</span> <span class="va">eyfp.colors</span>,</span>
<span>                       title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       height <span class="op">=</span> <span class="fl">11</span>, <span class="co"># Specify the height of the saved plot in inches</span></span>
<span>                       width <span class="op">=</span> <span class="fl">7.5</span>, <span class="co"># Specify the  width of the save plot in inches</span></span>
<span>                       region_label_angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                       label_text_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                       print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       flip_axis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       save_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                       legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>                       legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                       legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>                       facet_background_color <span class="op">=</span> <span class="st">"#FFFFFF"</span>,</span>
<span>                       image_ext <span class="op">=</span> <span class="st">".png"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $eyfp</span></span></code></pre>
<figure><img src="../reference/figures/eyfp_normalized_counts.png" alt="Image" style="width: 500px;"><figcaption><em>All mapped eYFP regions.</em>
</figcaption></figure><p>While the output of the following code chunks are not shown, this
function can easily be called for the other channels.</p>
<div class="section level5">
<h5 id="plotting-all-regions-with-mapped-c-fos-counts">Plotting all regions with mapped c-Fos counts<a class="anchor" aria-label="anchor" href="#plotting-all-regions-with-mapped-c-fos-counts"></a>
</h5>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chose the group colors for the cfos channel to plot as a hexadecimal color code</span></span>
<span><span class="va">cfos.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Context <span class="op">=</span> <span class="st">"#FFFFFF"</span>, Shock <span class="op">=</span> <span class="st">"#ff2a04"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot a long region bar plot</span></span>
<span><span class="fu"><a href="../reference/plot_normalized_counts.html">plot_normalized_counts</a></span><span class="op">(</span>e <span class="op">=</span> <span class="va">lh</span>,</span>
<span>                       channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cfos"</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Context"</span>, <span class="st">"Shock"</span><span class="op">)</span>,</span>
<span>                       colors <span class="op">=</span> <span class="va">cfos.colors</span>,</span>
<span>                       title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       height <span class="op">=</span> <span class="fl">11</span>, <span class="co"># Specify the height of the saved plot in inches</span></span>
<span>                       width <span class="op">=</span> <span class="fl">7.5</span>, <span class="co"># Specify the  width of the save plot in inches</span></span>
<span>                       region_label_angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                       label_text_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                       print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       flip_axis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       save_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2e+05</span><span class="op">)</span>,</span>
<span>                       legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                       legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>                       legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                       legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>                       facet_background_color <span class="op">=</span> <span class="st">"#FFFFFF"</span>,</span>
<span>                       image_ext <span class="op">=</span> <span class="st">".pdf"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $cfos</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="plotting-all-regions-with-mapped-colabeleyfp-counts">Plotting all regions with mapped colabel/eYFP counts<a class="anchor" aria-label="anchor" href="#plotting-all-regions-with-mapped-colabeleyfp-counts"></a>
</h5>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chose the group colors for the colabel channel to plot as a hexadecimal color code</span></span>
<span><span class="va">colabel.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Context <span class="op">=</span> <span class="st">"#FFFFFF"</span>, Shock <span class="op">=</span> <span class="st">"#ffc845"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_normalized_counts.html">plot_normalized_counts</a></span><span class="op">(</span>e <span class="op">=</span> <span class="va">lh</span>,</span>
<span>                       channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"colabel_over_eyfp"</span><span class="op">)</span>,</span>
<span>                       by <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Context"</span>, <span class="st">"Shock"</span><span class="op">)</span>,</span>
<span>                       colors <span class="op">=</span> <span class="va">colabel.colors</span>,</span>
<span>                       title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       height <span class="op">=</span> <span class="fl">11</span>,</span>
<span>                       width <span class="op">=</span> <span class="fl">7.5</span>,</span>
<span>                       unit_label <span class="op">=</span> <span class="st">"co-labelled/EYFP+"</span>,</span>
<span>                       region_label_angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                       label_text_size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                       print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       flip_axis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       save_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>                       legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                       legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>                       legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.85</span><span class="op">)</span>,</span>
<span>                       legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>                       facet_background_color <span class="op">=</span> <span class="st">"#e5f3e7"</span>,</span>
<span>                       image_ext <span class="op">=</span> <span class="st">".pdf"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $colabel_over_eyfp</span></span></code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="bar-plot-of-normalized-colabelled-cells-across-user-specified-regions">3.2 Bar plot of normalized colabelled cells across user-specified
regions<a class="anchor" aria-label="anchor" href="#bar-plot-of-normalized-colabelled-cells-across-user-specified-regions"></a>
</h3>
<p>If you would like to quickly look at the percentage of normalized
colabelled cells for a few specific regions, you can also use the
<code>plot_percent_colabel</code> function.</p>
<p>This function is designed to take up to two mouse attributes to “map”
to the respective graphs aesthetics of color and pattern to display on a
bar plot. The <code>rois</code> parameter allows for selective plotting
of specific regions and their subregions of interest. Just enter in a
few acronyms as a string vector into the <code>rois</code> parameter.
Below we will plot any regions that are subregions of the the Dentate
Gyrus (DG) or the Cornu Ammonis (CA).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_percent_colabel.html">plot_percent_colabel</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                     channel <span class="op">=</span> <span class="st">"eyfp"</span>, <span class="co"># Channel to be used as denominator in counts</span></span>
<span>                     color_mapping <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>                     colors <span class="op">=</span> <span class="va">eyfp.colors</span>,</span>
<span>                     plot_individual <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     save_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     rois <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DG"</span>, <span class="st">"CA"</span><span class="op">)</span>,</span>
<span>                     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">40</span><span class="op">)</span>,</span>
<span>                     image_ext <span class="op">=</span> <span class="st">".svg"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Checking also for child regions of specified roi(s). Only rois and child rois that overlap with common</span></span>
<span><span class="co">##             regions of both channels will be used.</span></span>
<span><span class="co">## Checking also for child regions of specified roi(s). Only rois and child rois that overlap with common</span></span>
<span><span class="co">##             regions of both channels will be used.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `geom_hline()`: Ignoring `mapping` because `yintercept` was</span></span>
<span><span class="co">## provided.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span>
<span></span>
<span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span>
<span></span>
<span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span>
<span></span>
<span><span class="co">## Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<figure><img src="../reference/figures/Colabeled_over_eyfp_plot_by_group.svg" alt="Image" style="width: 500px;"><figcaption><em>Selectively mapped co-labelled regions normalized by eYFP
counts.</em>
</figcaption></figure><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_percent_colabel.html">plot_percent_colabel</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                     channel <span class="op">=</span> <span class="st">"cfos"</span>, <span class="co"># Channel to be used as denominator in counts</span></span>
<span>                     color_mapping <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>                     colors <span class="op">=</span> <span class="va">cfos.colors</span>,</span>
<span>                     plot_individual <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     save_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     rois <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DG"</span>, <span class="st">"CA"</span><span class="op">)</span>,</span>
<span>                     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">40</span><span class="op">)</span>,</span>
<span>                     image_ext <span class="op">=</span> <span class="st">".svg"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Checking also for child regions of specified roi(s). Only rois and child rois that overlap with common</span></span>
<span><span class="co">##             regions of both channels will be used.</span></span>
<span><span class="co">## Checking also for child regions of specified roi(s). Only rois and child rois that overlap with common</span></span>
<span><span class="co">##             regions of both channels will be used.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `geom_hline()`: Ignoring `mapping` because `yintercept` was</span></span>
<span><span class="co">## provided.</span></span></code></pre>
<figure><img src="../reference/figures/Colabeled_over_cfos_plot_by_group.svg" alt="Image" style="width: 500px;"><figcaption><em>Selectively mapped co-labelled regions normalized by c-Fos
count.</em>
</figcaption></figure><blockquote>
<p>Note: The optional package ggpattern is required for mapping to the
pattern aesthetic using the pattern_mapping parameter so make sure it is
installed before running this function.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="correlation-heatmap-analysis">3.3 Correlation Heatmap Analysis<a class="anchor" aria-label="anchor" href="#correlation-heatmap-analysis"></a>
</h3>
<p>We can automatically plot heatmaps of the pairwise region
correlations using the function
<code><a href="../reference/plot_correlation_heatmaps.html">plot_correlation_heatmaps()</a></code>. Here we simply specify the
name of the correlation list and the respective colors (in a hexadecimal
string) corresponding to the channels that were specified in
<code><a href="../reference/get_correlations.html">get_correlations()</a></code>.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_correlation_heatmaps.html">plot_correlation_heatmaps</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                          channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                          correlation_list_name <span class="op">=</span> <span class="st">"Context"</span>,</span>
<span>                          sig_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                          sig_nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, <span class="co"># helps center and shift the significance asterisks</span></span>
<span>                          print_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"#00782e"</span><span class="op">)</span>,</span>
<span>                          save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_correlation_heatmaps.html">plot_correlation_heatmaps</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                          channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                          correlation_list_name <span class="op">=</span> <span class="st">"Shock"</span>,</span>
<span>                          sig_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                          sig_nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>                          print_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                          colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"#00782e"</span><span class="op">)</span>,</span>
<span>                          save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_text()`).</span></span>
<span></span>
<span><span class="co">## Warning: Removed 16 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_text()`).</span></span></code></pre>
<figure><img src="../reference/figures/heatmap_Context_eyfp.png" alt="Image" style="width: 500px;"><figcaption><em>Regional correlation heatmap for eYFP activity in the Context
group.</em>
</figcaption></figure><figure><img src="../reference/figures/heatmap_Shock_eyfp.png" alt="Image" style="width: 500px;"><figcaption><em>Regional correlation heatmap for eYFP activity in the Inescapable
Shock group.</em>
</figcaption></figure>
</div>
<div class="section level3">
<h3 id="visualization-of-correlation-permutation-analysis">3.4 Visualization of correlation permutation analysis<a class="anchor" aria-label="anchor" href="#visualization-of-correlation-permutation-analysis"></a>
</h3>
<p><code><a href="../reference/volcano_plot.html">volcano_plot()</a></code> shows us a summary of the analysis
results, and plots the pearson correlation coefficient differences (CT
pearson coefficient - IS pearson coefficient) against their permuted
p-values against a null distribution.</p>
<p>The horizontal line represents the designated significance cutoff.
The vertical lines plotted at +/- 1 allow for easier visualization of
correlation differences that are large between groups. The colored dots
in the upper right or left quadrants, including those which intersect
the significance line, indicate the most significantly different
regional connections between the groups, which have pearson correlation
differences with a magnitude &gt; 1.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># User optional theme to define the aesthetics of the plot using ggplot2 syntax</span></span>
<span><span class="va">plt_theme</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">34</span><span class="op">)</span>,</span>
<span>        line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>        axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">36</span><span class="op">)</span>,</span>
<span>        axis.ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">5.5</span>,<span class="st">"points"</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span><span class="fl">34</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">34</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2</span></span>
<span><span class="co">## 3.4.0.</span></span>
<span></span>
<span><span class="co">## Warning: Please use the `linewidth` argument instead.</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot a volcano plot</span></span>
<span><span class="fu"><a href="../reference/volcano_plot.html">volcano_plot</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>             permutation_comparison <span class="op">=</span> <span class="st">"Context_vs_Shock"</span>,</span>
<span>             channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>             colors <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00782e"</span><span class="op">)</span>,</span>
<span>             height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>             width <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             title <span class="op">=</span> <span class="st">""</span>,</span>
<span>             print_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>             point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             plt_theme <span class="op">=</span> <span class="va">plt_theme</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $eyfp</span></span></code></pre>
<figure><img src="../reference/figures/volcano_plot__eyfp.png" alt="Image" style="width: 500px;"><figcaption><em>Volcano plot for the eYFP channel.</em>
</figcaption></figure><p>Next, we can better visualize which actual region pairs are different
between our two analysis groups and in which direction their correlation
coefficients change with <code><a href="../reference/parallel_coordinate_plot.html">parallel_coordinate_plot()</a></code>. Only
region pairs from the volcano plot that are above the alpha level and
have correlation coefficient differences greater than absolute one are
included in this graph.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># User optional theme to define the aesthetics of the plot using ggplot2 syntax</span></span>
<span><span class="va">plt_theme</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">34</span><span class="op">)</span>,</span>
<span>        line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>        axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">36</span><span class="op">)</span>,</span>
<span>        axis.ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">5.5</span>,<span class="st">"points"</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span><span class="fl">34</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">34</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot a parallel coordinate plot</span></span>
<span><span class="fu"><a href="../reference/parallel_coordinate_plot.html">parallel_coordinate_plot</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>                         permutation_comparison <span class="op">=</span> <span class="st">"Context_vs_Shock"</span>,</span>
<span>                         channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>                         colors <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00782e"</span><span class="op">)</span>,</span>
<span>                         x_label_group_1 <span class="op">=</span> <span class="st">"CT"</span>,</span>
<span>                         x_label_group_2 <span class="op">=</span> <span class="st">"IS"</span>,</span>
<span>                         height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                         width <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                         print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         label_size <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                         plt_theme<span class="op">=</span> <span class="va">plt_theme</span></span>
<span>                         <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $eyfp</span></span></code></pre>
<figure><img src="../reference/figures/Context_vs_Shock_parallel_coordinate_plot_eyfp_.png" alt="Image" style="width: 500px;"><figcaption><em>Parallel coordinate plot for the eYFP channel.</em>
</figcaption></figure>
</div>
<div class="section level3">
<h3 id="plot-network-plots">3.5 Plot network plots<a class="anchor" aria-label="anchor" href="#plot-network-plots"></a>
</h3>
<p>The <code><a href="../reference/plot_networks.html">plot_networks()</a></code> function automatically plots the
output of <code><a href="../reference/create_networks.html">create_networks()</a></code>. You must specify the name of
the network you want to plot. There a some customizable features such as
setting the edge color (taken as a hexadecimal string) for positively
correlated connections. Additionally, you can further customize
aesthetics by adding themes compatible with <a href="https://rdrr.io/cran/ggraph/man/theme_graph.html" class="external-link">ggraph</a> and
<code>ggplot2</code> themes. Below we will plot the networks for the
eyfp channel in Context and Inescapable Shock groups.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Custom ggplot and ggraph themes </span></span>
<span><span class="va">graph_theme</span> <span class="op">&lt;-</span> <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html" class="external-link">theme_graph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">36</span><span class="op">)</span>,</span>
<span>                                             legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,</span>
<span>                                             legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_networks.html">plot_networks</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>              network_name <span class="op">=</span><span class="st">"Context"</span>,</span>
<span>              channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>              title <span class="op">=</span> <span class="st">"Context"</span>,</span>
<span>              degree_scale_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span>              height <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              edge_color <span class="op">=</span> <span class="st">"#00782e"</span>,</span>
<span>              label_size <span class="op">=</span> <span class="fl">6</span>,</span>
<span>              label_offset <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not</span></span>
<span><span class="co">## found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not</span></span>
<span><span class="co">## found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## $eyfp</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_networks.html">plot_networks</a></span><span class="op">(</span><span class="va">lh</span>,</span>
<span>              network_name <span class="op">=</span> <span class="st">"Shock"</span>,</span>
<span>              channels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eyfp"</span><span class="op">)</span>,</span>
<span>              title <span class="op">=</span> <span class="st">"Shock"</span>,</span>
<span>              degree_scale_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span>,</span>
<span>              height <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              edge_color <span class="op">=</span> <span class="st">"#00782e"</span>,</span>
<span>              label_size <span class="op">=</span> <span class="fl">6</span>,</span>
<span>              label_offset <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## $eyfp</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font</span></span>
<span><span class="co">## family not found in Windows font database</span></span></code></pre>
<pre><code><span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span>
<span></span>
<span><span class="co">## Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span></span>
<span><span class="co">## font family not found in Windows font database</span></span></code></pre>
<figure><img src="../reference/figures/network_Context_eyfp.png" alt="Image" style="width: 500px;"><figcaption><em>eYFP activity network for the Context group.</em>
</figcaption></figure><figure><img src="../reference/figures/network_Shock_eyfp.png" alt="Image" style="width: 500px;"><figcaption><em>eYFP activity network for the Inescapable Shock group.</em>
</figcaption></figure>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michelle Jin.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
